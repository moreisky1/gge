

var template = {
    id: 7277549967278945474,
    sheets: [
        {
            sheet: {
                id: "stage1",
                title: "stage1",
            }
        }
        ,{
            sheet: {
                id: "stage2",
                title: "stage2",
            }
        }
        ,{
            sheet: {
                id: "stage3",
                title: "stage3",
            }
        }
        ,{
            sheet: {
                id: "stage4",
                title: "stage4",
            }
        }
        ,{
            sheet: {
                id: "stage5",
                title: "stage5",
            }
        }
        ,{
            sheet: {
                id: "stage6",
                title: "stage6",
            }
        }
        ,{
            sheet: {
                id: "stage7",
                title: "stage7",
            }
        }
        ,{
            sheet: {
                id: "stage8",
                title: "stage8",
            }
        }
    ],
    fields: [
        {
            field: {
                sheet_id: "stage1",
                name: "fld_lastname",
                type: "string",
                title: "fld_lastname",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage1",
                name: "fld_firstname",
                type: "string",
                title: "fld_firstname",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage1",
                name: "fld_middlename",
                type: "string",
                title: "fld_middlename",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage1",
                name: "fld_region",
                type: "foreign_elem",
                catalog: "region",
                title: "fld_region",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage1",
                name: "fld_city",
                type: "string",
                title: "fld_city",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage1",
                name: "fld_birthdate",
                type: "date",
                title: "fld_birthdate",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage1",
                name: "fld_phone",
                type: "string",
                title: "fld_phone",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage1",
                name: "fld_email",
                type: "string",
                title: "fld_email",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage1",
                name: "fld_status",
                type: "combo",
                entries: [
                    {
                        entry: {
                            value: "Студент или аспирант вуза"
                        }
                    }
                    ,{
                        entry: {
                            value: "Работник организации"
                        }
                    }
                ],
                title: "fld_status",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage2",
                name: "fld_university",
                type: "string",
                title: "fld_university",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage2",
                name: "fld_univercity_custom",
                type: "string",
                title: "fld_univercity_custom",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage2",
                name: "fld_educ_level",
                type: "string",
                title: "fld_educ_level",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage2",
                name: "fld_specialization",
                type: "text",
                title: "fld_specialization",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage2",
                name: "fld_educ_year",
                type: "string",
                title: "fld_educ_year",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage2",
                name: "fld_command_exist",
                type: "string",
                title: "fld_command_exist",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage2",
                name: "fld_command_name",
                type: "text",
                title: "fld_command_name",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_organization",
                type: "text",
                title: "fld_organization",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_organization_site",
                type: "string",
                title: "fld_organization_site",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_organization_role",
                type: "string",
                title: "fld_organization_role",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_organization_field",
                type: "text",
                title: "fld_organization_field",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_subdivision",
                type: "text",
                title: "fld_subdivision",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_position",
                type: "string",
                title: "fld_position",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_experience",
                type: "string",
                title: "fld_experience",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_project_role",
                type: "string",
                title: "fld_project_role",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_area",
                type: "text",
                title: "fld_area",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage3",
                name: "fld_command_name_3",
                type: "text",
                title: "fld_command_name_3",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage4",
                name: "fld_collaborator_q1",
                type: "text",
                title: "fld_collaborator_q1",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage4",
                name: "fld_collaborator_q2",
                type: "text",
                title: "fld_collaborator_q2",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage4",
                name: "fld_collaborator_q3",
                type: "text",
                title: "fld_collaborator_q3",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage4",
                name: "fld_collaborator_q4",
                type: "text",
                title: "fld_collaborator_q4",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage5",
                name: "fld_collaborator_q5",
                type: "text",
                title: "fld_collaborator_q5",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage5",
                name: "fld_collaborator_q6",
                type: "text",
                title: "fld_collaborator_q6",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage5",
                name: "fld_collaborator_q7",
                type: "text",
                title: "fld_collaborator_q7",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage5",
                name: "fld_collaborator_q8",
                type: "text",
                title: "fld_collaborator_q8",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage5",
                name: "fld_collaborator_q9",
                type: "text",
                title: "fld_collaborator_q9",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage5",
                name: "fld_collaborator_q10",
                type: "text",
                title: "fld_collaborator_q10",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage6",
                name: "fld_command_exist_6",
                type: "string",
                title: "fld_command_exist_6",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage6",
                name: "fld_command_name_6",
                type: "text",
                title: "fld_command_name_6",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage6",
                name: "fld_previous_participant",
                type: "string",
                title: "fld_previous_participant",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage6",
                name: "fld_previous_stage",
                type: "string",
                title: "fld_previous_stage",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage6",
                name: "fld_theme",
                type: "text",
                title: "fld_theme",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage6",
                name: "fld_previous_project_role",
                type: "string",
                title: "fld_previous_project_role",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage7",
                name: "fld_collaborator_q11",
                type: "text",
                title: "fld_collaborator_q11",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage7",
                name: "fld_collaborator_q12",
                type: "text",
                title: "fld_collaborator_q12",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage7",
                name: "fld_collaborator_q13",
                type: "text",
                title: "fld_collaborator_q13",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage7",
                name: "fld_collaborator_q14",
                type: "text",
                title: "fld_collaborator_q14",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage7",
                name: "fld_collaborator_q15",
                type: "text",
                title: "fld_collaborator_q15",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage8",
                name: "fld_collaborator_q16",
                type: "string",
                title: "fld_collaborator_q16",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage8",
                name: "fld_collaborator_q17",
                type: "string",
                title: "fld_collaborator_q17",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage8",
                name: "fld_collaborator_q18",
                type: "text",
                title: "fld_collaborator_q18",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage8",
                name: "fld_collaborator_q19",
                type: "text",
                title: "fld_collaborator_q19",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage8",
                name: "fld_collaborator_q20",
                type: "text",
                title: "fld_collaborator_q20",
                disp_web: 1,
                is_required: 1
            }
        }
        ,{
            field: {
                sheet_id: "stage8",
                name: "fld_collaborator_q21",
                type: "string",
                title: "fld_collaborator_q21",
                disp_web: 1,
                is_required: 1
            }
        }
    ]
}
var template_xml = "<item>" + tools.object_to_text(template, "xml") + "</item>"; 
item = custom_templates.request_type.items.ObtainChildByKey(template.id); 
item.Clear(); 
item.LoadData(template_xml);
custom_templates.Doc.Save();
// alert(tools.object_to_text(custom_templates.request_type.items.ObtainChildByKey(7277549967278945474), "xml"))